# Proxy Track Service

ะกะตัะฒะธั-ะฟัะพะบัะธ ะดะปั ะพััะปะตะถะธะฒะฐะฝะธั ะฟะพััะปะพะบ ั ะฑะฐััะธะฝะณะพะผ ะทะฐะฟัะพัะพะฒ ะบ ะฒะฝะตัะฝะตะผั API 4px.

## ๐ ะะพะทะผะพะถะฝะพััะธ

- **ะะฐััะธะฝะณ ะทะฐะฟัะพัะพะฒ**: ะััะฟะฟะธััะตั ะทะฐะฟัะพัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะดะปั ะพะฟัะธะผะธะทะฐัะธะธ ะฒะฝะตัะฝะธั API ะฒัะทะพะฒะพะฒ
- **ะััะธัะพะฒะฐะฝะธะต**: ะัะฟะพะปัะทัะตั Redis ะดะปั ะบััะธัะพะฒะฐะฝะธั ัะตะทัะปััะฐัะพะฒ ะพััะปะตะถะธะฒะฐะฝะธั
- **Web Scraping**: ะะพะปััะฐะตั ะดะฐะฝะฝัะต ะพ ะฟะพััะปะบะฐั ั ัะฐะนัะฐ 4px
- **Docker Support**: ะะพะปะฝะฐั ะบะพะฝัะตะนะฝะตัะธะทะฐัะธั ั Docker Compose
- **Graceful Shutdown**: ะะพััะตะบัะฝะพะต ะทะฐะฒะตััะตะฝะธะต ัะฐะฑะพัั ัะตัะฒะธัะฐ
- **Health Checks**: ะะพะฝะธัะพัะธะฝะณ ัะพััะพัะฝะธั ัะตัะฒะธัะฐ

## ๐ ะขัะตะฑะพะฒะฐะฝะธั

- Docker ะธ Docker Compose
- Go 1.25+ (ะดะปั ะปะพะบะฐะปัะฝะพะน ัะฐะทัะฐะฑะพัะบะธ)

## ๐ ะฃััะฐะฝะพะฒะบะฐ ะธ ะทะฐะฟััะบ

### ะัััััะน ะทะฐะฟััะบ ั Docker

1. **ะะปะพะฝะธััะนัะต ัะตะฟะพะทะธัะพัะธะน:**
```bash
git clone https://github.com/ShamikRama/proxy_track_service.git
cd proxy_track_service
```

2. **ะะฐะฟัััะธัะต ัะตัะฒะธั:**
```bash
docker-compose up -d --build
```

3. **ะัะพะฒะตัััะต ััะฐััั:**
```bash
docker-compose ps
```

### ะะพะบะฐะปัะฝะฐั ัะฐะทัะฐะฑะพัะบะฐ

1. **ะฃััะฐะฝะพะฒะธัะต ะทะฐะฒะธัะธะผะพััะธ:**
```bash
go mod download
```

2. **ะะฐะฟัััะธัะต Redis:**
```bash
docker-compose up -d redis
```

3. **ะกะพะทะดะฐะนัะต .env ัะฐะนะป:**
```bash
cp .env.example .env
```

4. **ะะฐะฟัััะธัะต ัะตัะฒะธั:**
```bash
go run cmd/server/main.go
```

## ๐ง ะะพะฝัะธะณััะฐัะธั

ะกะพะทะดะฐะนัะต ัะฐะนะป `.env` ะฒ ะบะพัะฝะต ะฟัะพะตะบัะฐ:

```env
# Server Configuration
SERVER_PORT=8080
SERVER_READ_TIMEOUT=30s
SERVER_WRITE_TIMEOUT=30s

# Batcher Configuration
BATCHER_BATCH_SIZE=50
BATCHER_BATCH_TIMEOUT=2s
BATCHER_WORKERS=2

# Redis Configuration
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# External API Configuration
EXTERNAL_API_URL=https://track.4px.com
EXTERNAL_API_TIMEOUT=30s
EXTERNAL_HASH_PATTERN=4px
```

## ๐ก API Endpoints

### ะัะฝะพะฒะฝัะต endpoints

- `GET /` - ะะฝัะพัะผะฐัะธั ะพ ัะตัะฒะธัะต
- `GET /health` - ะัะพะฒะตัะบะฐ ัะพััะพัะฝะธั ัะตัะฒะธัะฐ
- `GET /track/{trackCode}` - ะััะปะตะถะธะฒะฐะฝะธะต ะฟะพััะปะบะธ

### ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

**ะัะพะฒะตัะบะฐ ัะพััะพัะฝะธั ัะตัะฒะธัะฐ:**
```bash
curl http://localhost:8080/health
```

**ะััะปะตะถะธะฒะฐะฝะธะต ะฟะพััะปะบะธ:**
```bash
curl http://localhost:8080/track/TEST123
```

**ะัะฒะตั ัะตัะฒะธัะฐ:**
```json
{
  "status": true,
  "data": {
    "countries": ["TEST123 - In Transit"],
    "events": [
      {
        "status": "Package received",
        "date": "2025-09-18T03:53:58Z"
      }
    ]
  }
}
```

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะะฐะฟััะบ ัะตััะพะฒ

```bash
# ะัะต ัะตััั
go test ./...

# ะขะตััั ะฑะฐััะตัะฐ
go test ./internal/batcher/ -v

# ะขะตััั ั ะฟะพะบัััะธะตะผ
go test ./... -cover
```

### ะขะตััั ะฑะฐััะธะฝะณะฐ

ะกะตัะฒะธั ะฒะบะปััะฐะตั ัะตััั ะดะปั ะฟัะพะฒะตัะบะธ ะปะพะณะธะบะธ ะฑะฐััะธะฝะณะฐ:

- **TestBatcherBatchSize**: ะัะพะฒะตััะตั ะฝะฐะบะพะฟะปะตะฝะธะต ะทะฐะฟัะพัะพะฒ ะดะพ ัะฐะทะผะตัะฐ ะฑะฐััะฐ
- **TestBatcherTimeout**: ะัะพะฒะตััะตั ะพัะฟัะฐะฒะบั ะฑะฐััะฐ ะฟะพ ัะฐะนะผะฐััั
- **TestBatcherMultipleBatches**: ะัะพะฒะตััะตั ะพะฑัะฐะฑะพัะบั ะฝะตัะบะพะปัะบะธั ะฑะฐััะตะน
- **TestBatcherConcurrency**: ะัะพะฒะตััะตั ะบะพะฝะบััะตะฝัะฝัั ะพะฑัะฐะฑะพัะบั

## ๐ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   HTTP Client   โโโโโถโ  Track Handler  โโโโโถโ Tracking Serviceโ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
                                                       โ
                                                       โผ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   Redis Cache   โโโโโโ     Batcher     โโโโโถโ  External API   โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
```

### ะะพะผะฟะพะฝะตะฝัั

- **Track Handler**: HTTP ะพะฑัะฐะฑะพััะธะบ ะทะฐะฟัะพัะพะฒ
- **Tracking Service**: ะัะฝะพะฒะฝะฐั ะฑะธะทะฝะตั-ะปะพะณะธะบะฐ
- **Batcher**: ะััะฟะฟะธััะตั ะทะฐะฟัะพัั ะฟะพ ััะปะพะฒะธัะผ:
  - ะะฐะบะพะฟะธะปะพัั 50 ััะตะบ-ะบะพะดะพะฒ
  - ะัะพัะปะพ ะฑะพะปะตะต 2 ัะตะบัะฝะด
- **Cache**: Redis ะดะปั ะบััะธัะพะฒะฐะฝะธั ัะตะทัะปััะฐัะพะฒ
- **External Client**: Web scraping ะบะปะธะตะฝั ะดะปั 4px

## ๐ ะะพะฝะธัะพัะธะฝะณ

### Health Check

```bash
curl http://localhost:8080/health
```

**ะฃัะฟะตัะฝัะน ะพัะฒะตั:**
```json
{
  "status": true,
  "message": "service is healthy",
  "service": "proxy_track_service"
}
```

### ะะพะณะธ

```bash
# ะะพะณะธ ะฒัะตั ัะตัะฒะธัะพะฒ
docker-compose logs

# ะะพะณะธ ัะพะปัะบะพ tracking-service
docker-compose logs tracking-service

# ะะพะณะธ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
docker-compose logs -f tracking-service
```

## ๐ณ Docker

### ะะพะผะฐะฝะดั Docker Compose

```bash
# ะะฐะฟััะบ
docker-compose up -d

# ะะตัะตัะฑะพัะบะฐ ะธ ะทะฐะฟััะบ
docker-compose up -d --build

# ะััะฐะฝะพะฒะบะฐ
docker-compose down

# ะัะพัะผะพัั ะปะพะณะพะฒ
docker-compose logs -f

# ะกัะฐััั ัะตัะฒะธัะพะฒ
docker-compose ps
```

### ะกัััะบัััะฐ ะบะพะฝัะตะนะฝะตัะพะฒ

- **tracking-service**: ะัะฝะพะฒะฝะพะน ัะตัะฒะธั (ะฟะพัั 8080)
- **tracking-redis**: Redis ะดะปั ะบััะธัะพะฒะฐะฝะธั (ะฟะพัั 6379)

## ๐ง ะะฐะทัะฐะฑะพัะบะฐ

### ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
โโโ cmd/
โ   โโโ server/           # ะขะพัะบะฐ ะฒัะพะดะฐ ะฟัะธะปะพะถะตะฝะธั
โโโ internal/
โ   โโโ batcher/          # ะะพะณะธะบะฐ ะฑะฐััะธะฝะณะฐ
โ   โโโ client/           # ะะปะธะตะฝัั ะฒะฝะตัะฝะธั API
โ   โโโ config/           # ะะพะฝัะธะณััะฐัะธั
โ   โโโ handler/          # HTTP ะพะฑัะฐะฑะพััะธะบะธ
โ   โโโ repository/       # ะะตะฟะพะทะธัะพัะธะธ ะดะฐะฝะฝัั
โ   โโโ service/          # ะะธะทะฝะตั-ะปะพะณะธะบะฐ
โโโ pkg/
โ   โโโ models/           # ะะพะดะตะปะธ ะดะฐะฝะฝัั
โโโ docker-compose.yml    # Docker Compose ะบะพะฝัะธะณััะฐัะธั
โโโ Dockerfile           # Docker ะพะฑัะฐะท
โโโ README.md            # ะะพะบัะผะตะฝัะฐัะธั
```

### ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒัั ัะตััะพะฒ

1. ะกะพะทะดะฐะนัะต ัะตััะพะฒัะน ัะฐะนะป: `*_test.go`
2. ะัะฟะพะปัะทัะนัะต mock ะพะฑัะตะบัั ะดะปั ะธะทะพะปััะธะธ ัะตััะพะฒ
3. ะัะพะฒะตััะนัะต ะบะฐะบ ััะฟะตัะฝัะต, ัะฐะบ ะธ ะพัะธะฑะพัะฝัะต ััะตะฝะฐัะธะธ

### ะะธะฝัะธะฝะณ ะธ ัะพัะผะฐัะธัะพะฒะฐะฝะธะต

```bash
# ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ะบะพะดะฐ
go fmt ./...

# ะะธะฝัะธะฝะณ
golangci-lint run

# ะัะพะฒะตัะบะฐ ะธะผะฟะพััะพะฒ
goimports -w .
```

## ๐จ ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ

### ะกะตัะฒะธั ะฝะต ะทะฐะฟััะบะฐะตััั

1. ะัะพะฒะตัััะต ะปะพะณะธ:
```bash
docker-compose logs tracking-service
```

2. ะัะพะฒะตัััะต ะฟะพััั:
```bash
netstat -an | grep 8080
```

3. ะัะพะฒะตัััะต ะบะพะฝัะธะณััะฐัะธั:
```bash
docker-compose config
```

### ะัะธะฑะบะธ Redis

1. ะัะพะฒะตัััะต ััะฐััั Redis:
```bash
docker-compose ps redis
```

2. ะัะพะฒะตัััะต ะฟะพะดะบะปััะตะฝะธะต:
```bash
docker exec tracking-redis redis-cli ping
```

### ะัะธะฑะบะธ ะฒะฝะตัะฝะตะณะพ API

1. ะัะพะฒะตัััะต ะดะพัััะฟะฝะพััั ัะฐะนัะฐ:
```bash
curl -I https://track.4px.com
```

2. ะัะพะฒะตัััะต ะปะพะณะธ scraping:
```bash
docker-compose logs tracking-service | grep "scraping"
```

## ๐ ะะธัะตะฝะทะธั

MIT License

## ๐ค ะะบะปะฐะด ะฒ ะฟัะพะตะบั

1. Fork ัะตะฟะพะทะธัะพัะธั
2. ะกะพะทะดะฐะนัะต feature branch
3. ะะพะฑะฐะฒััะต ัะตััั ะดะปั ะฝะพะฒะพะน ััะฝะบัะธะพะฝะฐะปัะฝะพััะธ
4. ะฃะฑะตะดะธัะตัั, ััะพ ะฒัะต ัะตััั ะฟัะพัะพะดัั
5. ะกะพะทะดะฐะนัะต Pull Request

## ๐ ะะพะดะดะตัะถะบะฐ

ะัะธ ะฒะพะทะฝะธะบะฝะพะฒะตะฝะธะธ ะฟัะพะฑะปะตะผ:

1. ะัะพะฒะตัััะต ัะฐะทะดะตะป "ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ"
2. ะกะพะทะดะฐะนัะต Issue ะฒ GitHub
3. ะัะธะปะพะถะธัะต ะปะพะณะธ ะธ ะพะฟะธัะฐะฝะธะต ะฟัะพะฑะปะตะผั